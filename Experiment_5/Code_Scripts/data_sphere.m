% Exp-5 : Transient Heat Conduction
% Deepanjhan Das [CH22B020]

% Data Files Generation | Sphere 
clear; close all;
format long;

%-------------------------------------------------------------------------%
t_heating_automatic = linspace(0, 120, 13);
sphere_heating_automatic = [36.6, 37.2, 36.7; 
    43.0, 41.2, 41.4; 59.3, 54.0, 57.7;
    72.2, 67.2, 70.5; 80.3, 76.3, 79.4;
    86.8, 83.1, 85.3; 91.1, 87.9, 90.0;
    94.4, 91.8, 93.0; 96.7, 94.7, 96.1;
    98.4, 96.8, 98.0; 99.6, 98.5, 99.3;
    100.0, 99.8, 100.0; 100.0, 100.0, 100.0];
writeCSV([t_heating_automatic', sphere_heating_automatic], 'automatic_sphere_heating.csv');


%-------------------------------------------------------------------------%
t_cooling_automatic = linspace(0, 1530, 52);
sphere_cooling_automatic = [100.0, 100.0, 100.0;
    99.7, 100.0, 100.0; 99.3, 100.0, 99.6; 98.6, 99.4, 98.7;
    97.6, 98.6, 97.9; 96.8, 97.7, 97.1; 96.1, 97.0, 96.3;
    95.4, 96.2, 95.6; 94.8, 95.6, 94.9; 93.3, 94.2, 93.5;
    92.7, 93.5, 92.9; 92.0, 92.8, 92.2; 91.4, 92.2, 91.6;
    90.7, 91.5, 90.8; 90.1, 90.9, 90.3; 89.5, 90.3, 89.7;
    88.9, 89.7, 89.3; 88.3, 89.1, 88.5; 87.7, 88.5, 87.9;
    87.1, 87.9, 87.3; 86.5, 87.3, 86.7; 85.9, 86.7, 86.1;
    85.2, 86.0, 85.4; 84.7, 85.5, 84.9; 84.1, 84.9, 84.3;
    83.6, 84.3, 83.7; 83.0, 83.8, 83.1; 82.4, 83.2, 82.6;
    82.0, 82.7, 82.1; 81.4, 82.1, 81.5; 80.3, 81.6, 81.0;
    80.5, 81.2, 80.6; 80.0, 80.2, 80.1; 79.2, 80.0, 79.4;
    78.7, 79.5, 79.0; 78.4, 79.1, 78.5; 77.9, 78.2, 78.1;
    77.4, 78.1, 77.6; 77.0, 77.2, 77.1; 76.6, 77.2, 76.6;
    76.0, 76.7, 76.1; 75.5, 76.2, 75.6; 75.1, 75.8, 75.2;
    74.6, 75.3, 74.7; 74.2, 74.9, 74.3; 73.8, 74.6, 73.9;
    73.3, 74.0, 73.5; 72.9, 73.6, 73.0; 72.4, 73.1, 72.6;
    72.0, 72.7, 72.2; 71.0, 72.3, 71.7; 70.9, 71.5, 71.0];
writeCSV([t_cooling_automatic', sphere_cooling_automatic], 'automatic_sphere_cooling.csv');


%-------------------------------------------------------------------------%
t_heating_manual = linspace(0, 140, 15);
sphere_heating_manual = [37.0, 37.0, 37.0; 45.0, 42.0, 49.0;
    61.0, 57.0, 65.0; 72.0, 69.0, 75.0; 80.0, 78.0, 82.0;
    85.0, 84.0, 87.0; 89.0, 88.0, 90.0; 92.0, 91.0, 93.0; 
    94.0, 93.0, 94.0; 95.0, 94.0, 95.0; 96.0, 95.0, 96.0;
    97.0, 96.0, 97.0; 97.0, 97.0, 97.0; 98.0, 97.0, 98.0;
    98.0, 98.0, 98.0];
writeCSV([t_heating_manual', sphere_heating_manual], 'manual_sphere_heating.csv');


%-------------------------------------------------------------------------%
t_cooling_manual = linspace(0, 1200, 41);
sphere_cooling_manual = [98.0, 98.0, 98.0; 94.0, 95.0, 95.0;
    94.0, 94.0, 94.0; 93.0, 93.0, 93.0; 92.0, 93.0, 92.0;
    91.0, 92.0, 92.0; 91.0, 91.0, 91.0; 90.0, 90.0, 90.0;
    89.0, 90.0, 90.0; 88.0, 89.0, 89.0; 88.0, 88.0, 88.0;
    87.0, 87.0, 87.0; 86.0, 87.0, 87.0; 86.0, 86.0, 86.0; 
    85.0, 85.0, 85.0; 84.0, 85.0, 85.0; 84.0, 84.0, 84.0;
    83.0, 83.0, 83.0; 82.0, 83.0, 83.0; 82.0, 82.0, 82.0;
    81.0, 81.0, 81.0; 80.0, 81.0, 81.0; 80.0, 80.0, 80.0;
    79.0, 80.0, 80.0; 79.0, 79.0, 79.0; 78.0, 78.0, 78.0;
    77.0, 78.0, 78.0; 77.0, 77.0, 77.0; 76.0, 77.0, 77.0;
    76.0, 76.0, 76.0; 75.0, 75.0, 75.0; 74.0, 75.0, 75.0;
    74.0, 74.0, 75.0; 73.0, 73.0, 74.0; 73.0, 73.0, 73.0;
    72.0, 73.0, 73.0; 72.0, 72.0, 72.0; 71.0, 72.0, 72.0;
    71.0, 71.0, 71.0; 70.0, 71.0, 71.0; 70.0, 70.0, 70.0];
writeCSV([t_cooling_manual', sphere_cooling_manual], 'manual_sphere_cooling.csv');


%% To Create CSV Files
function writeCSV(M, file_name)
    T = array2table(M);
    T.Properties.VariableNames(1:4) = {'Time(s)', 'Thermocouple_1 Temp(deg C)', ...
    'Thermocouple_2 Temp(deg C)', 'Thermocouple_3 Temp(deg C)'};
    
    writetable(T, file_name);
end